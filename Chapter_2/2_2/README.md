# Jumping Ball

该项目为《C语言课程设计与游戏开发实践教程》的2.2节及其习题构成的产物。

其主要实现一个小球打砖块的游戏。

## 总体逻辑

### 游戏对象

+ 显示框（View）
  + 直接使用上一个项目的View类
  + 改进：存储两副图，一副为显示效果，一副为缓存
    + 每次改变都改动缓存
    + 新增`Flush()`函数用于将缓存写入显示效果，可以最小化光标移动量和屏幕输出改变
+ 小球（Ball）
  + 存储其坐标（`x`，`y`）与其速度方向矢量（`v_x`，`v_y`）
  + 初始化逻辑（`Init()`）
  + 移动逻辑（`Move()`，设定为固定时间执行移动）
  + 碰撞逻辑（`Collide()`，检测前进方向附近是否有物体，如果有则按特定逻辑改变方向）
    + 如果`(x, y + v_y)`方向有物体，则改变`v_y`方向
    + 如果`(x + v_x, y)`方向有物体，则改变`v_x`方向
    + 两种特殊情况会同时改变两个方向：
      + 仅有`(x + v_x, y + v_y)`下有物体
      + `(x, y + v_y)`和`(x + v_x, y)`下都有物体
+ 砖块集合（BlockSet）
  + 维护一个二元组集合，表示哪里有砖块
  + 生成逻辑（`Init()`，设定为完全随机生成）
  + 消除逻辑（`Erase()`，消除被碰撞的方块）
+ 移动挡板（Board）
  + 初始化逻辑（`Init()`）
  + 存储其x坐标与y坐标左端和右端，以及移动边界
  + 移动逻辑（`Move()`，根据参数矢量进行移动）
+ 全局变量
  + 计分，以及计算小球反弹次数

### Startup

按顺序调用如下逻辑：

+ 写入main函数的框体绘制
+ 小球初始化（固定值）
+ 挡板初始化（固定值）
+ 砖块初始化（传入生成范围）

### Show

改进后的显示类需要`show()`逻辑，仅调用其`Flush()`方法即可。

### Update With Input

读取输入并执行如下逻辑：

+ `wsad`：移动，调用Board的Move()

### Update Without Input

按顺序执行如下逻辑：

+ 小球检测碰撞（碰撞到砖块会调用砖块消除逻辑）
+ 小球移动逻辑
+ 小球检测碰撞（碰撞到砖块会调用砖块消除逻辑）